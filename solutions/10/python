a=b=0
for s in open(0,"rb"):d,*B,j=s.split();f=lambda V,i=0:(-1in[*V])*999or any(V)and(i<len(B)and min(-~f([x-(c+48in B[i])for c,x in enumerate(V)],i+1),f(V,i+1))or 999*any(x%2for x in V)or 2*f(q*[x>>1for x in V]));q=0;a+=f(d[1:-1]);q=1;b+=f(eval(j[1:-1]))
print(a,b)