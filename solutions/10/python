a=b=0
for s in open(0,"rb"):d,*B,j=s.split();f=lambda V,i=0:any(V)and(min(999*(min(U:=[x-(c+48in B[i])for c,x in enumerate(V)])<0)or-~f(U,i+1),f(V,i+1))if i<len(B)else 999*any(x%2for x in V)or(q and 2*f([x>>1for x in V])));q=0;a+=f(d[1:-1]);q=1;b+=f(eval(j[1:-1]))
print(a,b)