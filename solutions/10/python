import scipy,numpy as N
l=c=0
for z in open(0,'rb'):t,*b,j=z.split();v=[1]*len(b);R=range(k:=len(j:=eval(j[1:-1])));L=lambda B,*C:round(scipy.optimize.milp(v+[0]*B*k,integrality=v+[1]*B*k,constraints=C).fun);c+=L(0,x:=[[i+48in a for a in b]for i in R],j,j);l+=L(1,N.c_[x,-2*N.eye(k)],s:=[u%2for u in t[1:-1]],s)
print(l,c)