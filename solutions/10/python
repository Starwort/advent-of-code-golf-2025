import scipy,numpy as N
l=c=0
for z in open(0):t,*b,j=z.split();v=[1]*len(b);k=len(j:=eval(j[1:-1]));L=lambda B,*C:round(scipy.optimize.milp(v+[0]*B,integrality=v+[1]*B,constraints=C).fun);c+=L(0,x:=[[str(i)in a for a in b]for i in range(k)],j,j);l+=L(k,N.c_[x,-2*N.eye(k)],s:=[u<"."for u in t[1:-1]],s)
print(l,c)