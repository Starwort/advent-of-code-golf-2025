+/a:{
 m::{(c;r):+x;(?r){(y;x)}'.&/'c@=r}'((~!*/(#x)#2)#\:,(0;(#x)#0)){x,'(1;y)+/:/:x@2/~y=!(#y)#2}/y
 (&/*'m@2/x;{$[&/~x;0;|/0>x;9999; 9999&/(*'a)+2*o'-2!(x-*|)'a:m@2/2!x]}@z)}.'{(2!*p;~^-1_s?\:!#*p;*|s:`I$","\'1_p:1_'-1_'" "\x)}'0:0