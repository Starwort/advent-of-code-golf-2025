(L;B;J):+{(2!*p;~^-1_s?\:!#*p;*|s:`I$","\'1_p:1_'-1_'" "\x)}'0:0
+/L{&/+/2\&x~/:(~=/~y@&)'+!(#y)#2}'B
+/B{k::0
(A;b):+(0,#x)_/:(+x,,y){x@:>~~x;$[0^a:x[k;y];x[j]:(x[j]*a)-x[k]*/:x[j:(&~~x[;y])^k;y];:x];k+:1;x}/!#x
c:(*'b)-+/'(A@'v)*(t:+{$[~#y;,!0;,/o\:[x-/:i*\:l;-1_y],''i:!1+&/x@&l:*|y]}[y]x@V)(V:?,/v)?v:(1_&:)'~~A
&/+/q@\:&~(|/w!'c)|0>&/q:t,(-w:d|-d)!'c*0 0'd:A@'*'&'~~A}'J