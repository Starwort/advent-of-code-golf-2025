|/S:*/1+a|-a:{,/x-\:x}'+T:.'0:0
S@d@*<(|//{(0&':~x)&~=':y}.'|:\(+T,1#T){(1 0+y@<y)'x}'+)'T@+(#T)\d:>S