A:3*N:#B:.'0:0
(=N){x[;&m]:m:|/x@y;$[&/m; \**/B@y;A-:1;x;x& \*/a@3#>a:#'=x]}/+N\<,/+/'a*a:B-\:+B