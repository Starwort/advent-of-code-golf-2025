A:3*N:#B:.'0:0
(=N){$[&/m:|/x@y;` \**/B@y;A-:1;x[;&m]:m; \*/a@3#>a:#'=x];x}/+N\<,/+/'a*a:B-\:+B